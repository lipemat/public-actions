###################################################
# Setup and build plugin translations in a reusable action.
#
# env:
#   DIR: The directory of the plugin.
#
# @version 0.0.2
#
###################################################

name: Generate Plugin Translations
description: Setup and build plugin translations for PHP and JS.


runs:
  using: "composite"
  steps:
    - name: Install Translations Dependencies
      uses: lipemat/public-actions/install-translate@version/1

    - name: Install WP-CLI
      uses: lipemat/public-actions/install-wp-cli@version/1

    - name: Generate PRO JS translations
      run: |
        cd content/plugins/${{ env.PRO }}/dev/translate-cli
        php command.php
      shell: bash

    - if: ${{ hashFiles(format('content/plugins/{0}/dev/translate-cli/composer.json', env.BASIC )) != ''}}
      name: Generate Basic JS translations
      run: |
        cd content/plugins/${{ env.BASIC }}/dev/translate-cli
        php command.php
      shell: bash

    - name: Generate Basic PHP translations
      run: |
        cd content/plugins/${{ env.BASIC }}/languages
        wp i18n make-php .
      shell: bash

    - name: Generate PRO PHP translations
      run: |
        cd content/plugins/${{ env.PRO }}/languages
        wp i18n make-php .
      shell: bash
